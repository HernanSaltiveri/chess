(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{23:function(e,t,n){var a=n(53),i=["calculateMove"];e.exports=function(){var e=new Worker(n.p+"0fc64d1d64a10ab2b433.worker.js",{name:"[hash].worker.js"});return a(e,i),e}},28:function(e,t,n){e.exports=n.p+"static/media/white_pawn.41da1b5b.svg"},29:function(e,t,n){e.exports=n.p+"static/media/black_pawn.3cab4671.svg"},30:function(e,t,n){e.exports=n.p+"static/media/white_knight.3ece5029.svg"},31:function(e,t,n){e.exports=n.p+"static/media/black_knight.88ad52be.svg"},32:function(e,t,n){e.exports=n.p+"static/media/white_bishop.36a96cf8.svg"},33:function(e,t,n){e.exports=n.p+"static/media/black_bishop.341337f4.svg"},34:function(e,t,n){e.exports=n.p+"static/media/white_rook.007b43f5.svg"},35:function(e,t,n){e.exports=n.p+"static/media/black_rook.e7f61dec.svg"},36:function(e,t,n){e.exports=n.p+"static/media/white_queen.51d538db.svg"},37:function(e,t,n){e.exports=n.p+"static/media/black_queen.87612c77.svg"},38:function(e,t,n){e.exports=n.p+"static/media/white_king.9e716b1e.svg"},39:function(e,t,n){e.exports=n.p+"static/media/black_king.12ae1430.svg"},46:function(e,t,n){e.exports=n(62)},52:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var a=n(5),i=n.n(a),r=n(0),o=n.n(r),c=n(22),l=n.n(c),s=(n(52),n(3)),d=n(2),u=n(23),m=n.n(u),h=n(65),f=d.a.div.withConfig({displayName:"Field__FieldDiv",componentId:"l5smif-0"})(["position:relative;background-color:#fdf6e3;&:nth-child(even){background-color:#eee8d5;}&.move-mark:before{position:absolute;top:4%;left:4%;bottom:4%;right:4%;content:'';display:block;border:0.5vh solid ",";border-radius:50%;}"],(function(e){return e.markColor})),p=function(e){var t=e.boardIndex,n=e.children,a=e.movePiece,i=e.isStart,r=e.isEnd,c=e.isPossibleTarget,l=Object(h.a)({accept:"PIECE",drop:function(e,n){a(e.pieceId,e.boardIndex,t)}}),d=Object(s.a)(l,2)[1],u=i||r||c?"move-mark":"",m=c?"rgba(169,189,0,0.69)":i?"#dc322f9f":r?"#dc322faf":"white";return o.a.createElement(f,{ref:d,style:{position:"relative"},isStart:i,markColor:m,className:u},n)},g=n(66),v=n(28),b=n.n(v),y=n(29),w=n.n(y),_=n(30),k=n.n(_),x=n(31),E=n.n(x),M=n(32),j=n.n(M),I=n(33),C=n.n(I),O=n(34),A=n.n(O),P=n(35),S=n.n(P),D=n(36),N=n.n(D),G=n(37),R=n.n(G),T=n(38),B=n.n(T),z=n(39),K=n.n(z),Q=[b.a,k.a,j.a,A.a,N.a,B.a],Y=[w.a,E.a,C.a,S.a,R.a,K.a],q=["Pawn","Knight","Bishop","Rook","Queen","King"],F=d.a.div.withConfig({displayName:"Piece__PieceContainer",componentId:"xjorig-0"})(["-webkit-transform:translate3d(0,0,0);"]),L=d.a.img.withConfig({displayName:"Piece__PieceImage",componentId:"xjorig-1"})(["display:block;margin:13%;height:74%;width:74%;&.dragging{visibility:hidden;}"]),J=function(e){var t=e.boardIndex,n=e.color,a=e.piece,i=e.onPickup,r=e.onDrop,c=Math.abs(a),l="black"===n?Y[c-1]:Q[c-1],d=Object(g.a)({item:{type:"PIECE",pieceId:c,boardIndex:t},begin:function(e){return i(t)},end:function(e){return r(t)},collect:function(e){return{isDragging:!!e.isDragging()}}}),u=Object(s.a)(d,2),m=u[0].isDragging,h=u[1];return o.a.createElement(F,{ref:h},o.a.createElement(L,{src:l,alt:q[c-1],className:m?"dragging":""}))},W=d.a.div.withConfig({displayName:"Board__BoardGrid",componentId:"sc-1rho0e0-0"})(["display:grid;grid-template-columns:0 repeat(8,1fr);grid-template-rows:0 repeat(8,1fr);box-shadow:3px 3px 3px #586e75;@media (min-aspect-ratio:99/100){width:100vh;height:100vh;}@media (max-aspect-ratio:100/99){width:100vw;height:100vw;}"]),U=function(e){var t=e.board,n=e.lastMove,a=e.currentPieceMoves,i=e.handlePlayerMove,r=e.updatePossibleMoves,c=e.clearPossibleMoves;return o.a.createElement(W,null,t.map((function(e,t){return t%10===9||t>=100||t<10?null:99===e?o.a.createElement("div",{key:t,className:"board_frame"}):o.a.createElement(p,{key:t,boardIndex:t,movePiece:i,isStart:t===n.start,isEnd:t===n.end,isPossibleTarget:a.has(t)},0!==e&&o.a.createElement(J,{boardIndex:t,color:e<0?"black":"white",piece:e,onPickup:r,onDrop:c}))})))},H=d.a.div.withConfig({displayName:"AnimatedSpinner",componentId:"sc-1x64dsd-0"})(['color:#073642;display:inline-block;position:relative;width:80px;height:80px;margin-top:2rem;margin-right:3rem;margin-left:3rem;div{transform-origin:40px 40px;animation:lds-spinner 1.2s linear infinite;}div:after{content:" ";display:block;position:absolute;top:3px;left:37px;width:6px;height:18px;border-radius:20%;background:#073642;}div:nth-child(1){transform:rotate(0deg);animation-delay:-1.1s;}div:nth-child(2){transform:rotate(30deg);animation-delay:-1s;}div:nth-child(3){transform:rotate(60deg);animation-delay:-0.9s;}div:nth-child(4){transform:rotate(90deg);animation-delay:-0.8s;}div:nth-child(5){transform:rotate(120deg);animation-delay:-0.7s;}div:nth-child(6){transform:rotate(150deg);animation-delay:-0.6s;}div:nth-child(7){transform:rotate(180deg);animation-delay:-0.5s;}div:nth-child(8){transform:rotate(210deg);animation-delay:-0.4s;}div:nth-child(9){transform:rotate(240deg);animation-delay:-0.3s;}div:nth-child(10){transform:rotate(270deg);animation-delay:-0.2s;}div:nth-child(11){transform:rotate(300deg);animation-delay:-0.1s;}div:nth-child(12){transform:rotate(330deg);animation-delay:0s;}@keyframes lds-spinner{0%{opacity:1;}100%{opacity:0;}}']),V=function(){return o.a.createElement(H,null,o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))},X=d.a.div.withConfig({displayName:"GameMenu__MenuBar",componentId:"sc-1evhkun-0"})(["display:flex;flex-direction:column;margin-top:1.5rem;margin-left:2rem;text-align:center;@media (max-aspect-ratio:100/99){margin-left:auto;margin-right:auto;}"]),Z=d.a.div.withConfig({displayName:"GameMenu__MenuItem",componentId:"sc-1evhkun-1"})(["position:relative;display:",";align-self:center;padding-bottom:0.5rem;"],(function(e){return e.hidden?"none":"flex"})),$=d.a.button.withConfig({displayName:"GameMenu__GameButton",componentId:"sc-1evhkun-2"})(["background:white;color:#073642;border:1px solid #073642;border-radius:0.3rem;font-size:1rem;font-weight:bold;padding:0.5rem;width:11rem;box-shadow:1px 1px 1px #073642;&:hover{background:#073642;color:white;cursor:pointer;}"]),ee=d.a.label.withConfig({displayName:"GameMenu__Label",componentId:"sc-1evhkun-3"})(["position:absolute;top:1.3rem;width:100%;text-align:center;font-size:0.8rem;color:#073642;"]),te=Object(d.a)(Z).withConfig({displayName:"GameMenu__GameResult",componentId:"sc-1evhkun-4"})(["padding-top:2rem;font-weight:bold;font-size:1.5rem;color:#dc322f;;"]),ne=function(e){var t=e.isAiThinking,n=e.gameEnded,a=e.winningPlayerColor,i=e.startNewGame,r=e.forceAiMove,c=e.difficultyLevel,l=e.setSearchDepth;return o.a.createElement(X,null,o.a.createElement(Z,{hidden:t},o.a.createElement($,{disabled:t,onClick:i},"New Game")),o.a.createElement(Z,{hidden:t||n},o.a.createElement($,{disabled:t||n,onClick:r,title:"Let computer play the current color"},"Computer Move")),o.a.createElement(Z,{hidden:t},o.a.createElement(ee,{htmlFor:"game-menu_difficulty-slider"},"Difficulty"),o.a.createElement("input",{id:"game-menu_difficulty-slider",type:"range",min:"1",max:"5",title:"Difficulty",value:c,onChange:function(e){return l(e.target.value)}})),t&&o.a.createElement(V,null),n&&o.a.createElement(te,null,a?(1===a?"White":"Black")+" wins!":"Stalemate!"))},ae=n(18),ie=n(19),re=n(40),oe=function(){function e(){Object(ae.a)(this,e)}return Object(ie.a)(e,[{key:"init",value:function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.engine){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,i.a.awrap(Object(re.instantiate)(fetch("./as-api.wasm")));case 4:this.engine=e.sent,console.log("Engine initialized");case 6:case"end":return e.stop()}}),null,this)}},{key:"calculateMove",value:function(e,t,n){console.log("Start calculation of move ...");var a=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),i=this.engine.__retain(a),r=this.engine.calculateMove(i,t,n),o=ce.fromEncodedMove(r);return this.engine.__release(i),console.log("Calculation finished"),o}},{key:"performMove",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.performMove(a,t.encodedMove),r=this.engine.__getArray(i);return this.engine.__release(a),this.engine.__release(i),r}},{key:"generateMoves",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.generatePlayerMoves(a,t),r=this.engine.__getArray(i);return this.engine.__release(i),this.engine.__release(a),r.map(ce.fromEncodedMove)}},{key:"isCheckMate",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.isCheckMate(a,t);return this.engine.__release(a),i}}]),e}(),ce=function(){function e(t,n,a){Object(ae.a)(this,e),this.piece=t,this.start=n,this.end=a,this.encodedMove=t|n<<3|a<<10}return Object(ie.a)(e,null,[{key:"fromEncodedMove",value:function(t){return new e(7&t,t>>3&127,t>>10&127)}}]),e}(),le=new oe,se=m()(),de=[99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,-4,-2,-3,-5,-6,-3,-2,-4,99,99,-1,-1,-1,-1,-1,-1,-1,-1,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,1,1,1,1,1,1,1,1,99,99,4,2,3,5,6,3,2,4,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,0],ue=d.a.div.withConfig({displayName:"Game__GameArea",componentId:"qivay-0"})(["display:flex;flex-wrap:wrap;"]),me=function(){var e=Object(r.useState)(1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(!1),c=Object(s.a)(i,2),l=c[0],d=c[1],u=Object(r.useState)(de),m=Object(s.a)(u,2),h=m[0],f=m[1],p=Object(r.useState)(!1),g=Object(s.a)(p,2),v=g[0],b=g[1],y=Object(r.useState)({start:-1,end:-1}),w=Object(s.a)(y,2),_=w[0],k=w[1],x=Object(r.useState)(le.generateMoves(h,n)),E=Object(s.a)(x,2),M=E[0],j=E[1],I=Object(r.useState)(new Set),C=Object(s.a)(I,2),O=C[0],A=C[1],P=Object(r.useState)(),S=Object(s.a)(P,2),D=S[0],N=S[1],G=Object(r.useState)(3),R=Object(s.a)(G,2),T=R[0],B=R[1],z=function(e,t,n){d(!1),k(t);var i=le.performMove(e,t);if(f(i),le.isCheckMate(i,-n))return b(!0),void N(n);var r=le.generateMoves(i,-n);(j(r),0!==r.length)?a(-n):b(!0)};return o.a.createElement(ue,null,o.a.createElement(U,{board:h,lastMove:_,currentPieceMoves:O,handlePlayerMove:function(e,t,i){var r=Math.abs(e);if(!v&&!l&&function(e,t){return M.some((function(n){return n.start===e&&n.end===t}))}(t,i)){if(k({start:t,end:i}),1===r&&(1===n&&i<29||-1===n&&i>90))switch(prompt("Choose promotion (Q, R, B, K)","Q").toUpperCase()){case"R":r=4;break;case"B":r=3;break;case"K":r=6;break;case"Q":default:r=5}var o=le.performMove(h,new ce(r,t,i));if(f(o),le.isCheckMate(o,-n))return b(!0),void N(n);0!==le.generateMoves(o,-n).length?(d(!0),j([]),se.calculateMove(o,-n,T).then((function(e){return z(o,e,-n)})),a(-n)):b(!0)}},updatePossibleMoves:function(e){var t=M.filter((function(t){return t.start===e})).map((function(e){return e.end}));A(new Set(t))},clearPossibleMoves:function(){A(new Set)}}),o.a.createElement(ne,{isAiThinking:l,gameEnded:v,winningPlayerColor:D,startNewGame:function(){f(de),a(1),b(!1),k({start:-1,end:-1}),N(void 0),j(le.generateMoves(de,1)),A(new Set)},forceAiMove:function(){d(!0),se.calculateMove(h,n,T).then((function(e){return z(h,e,n)}))},searchDepth:T,setSearchDepth:B}))},he=n(64),fe=n(41),pe=n(42),ge=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=t.map((function(t){return t(e)}));return{setup:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.setup.apply(e,t)}))},teardown:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.teardown.apply(e,t)}))},connectDropTarget:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDropTarget.apply(e,t)}))},connectDragPreview:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDragPreview.apply(e,t)}))},connectDragSource:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDragSource.apply(e,t)}))}}}};var ve=function(){return o.a.createElement("main",null,o.a.createElement(he.a,{backend:ge(fe.a,pe.a)},o.a.createElement(me,null)))};i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.awrap(le.init());case 2:l.a.render(o.a.createElement(ve,null),document.getElementById("root"));case 3:case"end":return e.stop()}}))}},[[46,1,2]]]);
//# sourceMappingURL=main.6f4b9d91.chunk.js.map