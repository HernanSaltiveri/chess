(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{24:function(e,t,n){var a=n(54),i=["calculateMove"];e.exports=function(){var e=new Worker(n.p+"3d1b17ab5491e8dc22b1.worker.js",{name:"[hash].worker.js"});return a(e,i),e}},29:function(e,t,n){e.exports=n.p+"static/media/white_pawn.41da1b5b.svg"},30:function(e,t,n){e.exports=n.p+"static/media/black_pawn.3cab4671.svg"},31:function(e,t,n){e.exports=n.p+"static/media/white_knight.3ece5029.svg"},32:function(e,t,n){e.exports=n.p+"static/media/black_knight.88ad52be.svg"},33:function(e,t,n){e.exports=n.p+"static/media/white_bishop.36a96cf8.svg"},34:function(e,t,n){e.exports=n.p+"static/media/black_bishop.341337f4.svg"},35:function(e,t,n){e.exports=n.p+"static/media/white_rook.007b43f5.svg"},36:function(e,t,n){e.exports=n.p+"static/media/black_rook.e7f61dec.svg"},37:function(e,t,n){e.exports=n.p+"static/media/white_queen.51d538db.svg"},38:function(e,t,n){e.exports=n.p+"static/media/black_queen.87612c77.svg"},39:function(e,t,n){e.exports=n.p+"static/media/white_king.9e716b1e.svg"},40:function(e,t,n){e.exports=n.p+"static/media/black_king.12ae1430.svg"},47:function(e,t,n){e.exports=n(64)},53:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var a=n(5),i=n.n(a),r=n(10),o=n(0),c=n.n(o),l=n(23),s=n.n(l),d=(n(53),n(3)),u=n(2),m=n(24),h=n.n(m),f=n(67),p=u.a.div.withConfig({displayName:"Field__FieldDiv",componentId:"l5smif-0"})(["position:relative;background-color:#fdf6e3;&:nth-child(even){background-color:#eee8d5;}&.move-mark:before{position:absolute;top:4%;left:4%;bottom:4%;right:4%;content:'';display:block;border:0.5vh solid ",";border-radius:50%;}"],(function(e){return e.markColor})),g=function(e){var t=e.boardIndex,n=e.children,a=e.movePiece,i=e.isStart,r=e.isEnd,o=e.isPossibleTarget,l=Object(f.a)({accept:"PIECE",drop:function(e,n){a(e.pieceId,e.boardIndex,t)}}),s=Object(d.a)(l,2)[1],u=i||r||o?"move-mark":"",m=o?"rgba(169,189,0,0.69)":i?"#dc322f9f":r?"#dc322faf":"white";return c.a.createElement(p,{ref:s,style:{position:"relative"},isStart:i,markColor:m,className:u},n)},v=n(68),b=n(29),y=n.n(b),w=n(30),_=n.n(w),k=n(31),x=n.n(k),E=n(32),M=n.n(E),j=n(33),I=n.n(j),O=n(34),C=n.n(O),A=n(35),P=n.n(A),S=n(36),D=n.n(S),N=n(37),G=n.n(N),R=n(38),T=n.n(R),B=n(39),z=n.n(B),K=n(40),Q=n.n(K),Y=[y.a,x.a,I.a,P.a,G.a,z.a],q=[_.a,M.a,C.a,D.a,T.a,Q.a],F=["Pawn","Knight","Bishop","Rook","Queen","King"],J=u.a.div.withConfig({displayName:"Piece__PieceContainer",componentId:"xjorig-0"})(["-webkit-transform:translate3d(0,0,0);"]),L=u.a.img.withConfig({displayName:"Piece__PieceImage",componentId:"xjorig-1"})(["display:block;margin:13%;height:74%;width:74%;&.dragging{visibility:hidden;}"]),W=function(e){var t=e.boardIndex,n=e.color,a=e.piece,i=e.onPickup,r=e.onDrop,o=Math.abs(a),l="black"===n?q[o-1]:Y[o-1],s=Object(v.a)({item:{type:"PIECE",pieceId:o,boardIndex:t},begin:function(e){return i(t)},end:function(e){return r(t)},collect:function(e){return{isDragging:!!e.isDragging()}}}),u=Object(d.a)(s,2),m=u[0].isDragging,h=u[1];return c.a.createElement(J,{ref:h},c.a.createElement(L,{src:l,alt:F[o-1],className:m?"dragging":""}))},U=u.a.div.withConfig({displayName:"Board__BoardGrid",componentId:"sc-1rho0e0-0"})(["display:grid;grid-template-columns:0 repeat(8,1fr);grid-template-rows:0 repeat(8,1fr);box-shadow:3px 3px 3px #586e75;@media (min-aspect-ratio:99/100){width:100vh;height:100vh;}@media (max-aspect-ratio:100/99){width:100vw;height:100vw;}"]),H=function(e){var t=e.board,n=e.lastMove,a=e.currentPieceMoves,i=e.handlePlayerMove,r=e.updatePossibleMoves,o=e.clearPossibleMoves;return c.a.createElement(U,null,t.map((function(e,t){return t%10===9||t>=100||t<10?null:99===e?c.a.createElement("div",{key:t,className:"board_frame"}):c.a.createElement(g,{key:t,boardIndex:t,movePiece:i,isStart:t===n.start,isEnd:t===n.end,isPossibleTarget:a.has(t)},0!==e&&c.a.createElement(W,{boardIndex:t,color:e<0?"black":"white",piece:e,onPickup:r,onDrop:o}))})))},V=u.a.div.withConfig({displayName:"AnimatedSpinner",componentId:"sc-1x64dsd-0"})(['color:#073642;display:inline-block;position:relative;width:80px;height:80px;margin-top:2rem;margin-right:3rem;margin-left:3rem;div{transform-origin:40px 40px;animation:lds-spinner 1.2s linear infinite;}div:after{content:" ";display:block;position:absolute;top:3px;left:37px;width:6px;height:18px;border-radius:20%;background:#073642;}div:nth-child(1){transform:rotate(0deg);animation-delay:-1.1s;}div:nth-child(2){transform:rotate(30deg);animation-delay:-1s;}div:nth-child(3){transform:rotate(60deg);animation-delay:-0.9s;}div:nth-child(4){transform:rotate(90deg);animation-delay:-0.8s;}div:nth-child(5){transform:rotate(120deg);animation-delay:-0.7s;}div:nth-child(6){transform:rotate(150deg);animation-delay:-0.6s;}div:nth-child(7){transform:rotate(180deg);animation-delay:-0.5s;}div:nth-child(8){transform:rotate(210deg);animation-delay:-0.4s;}div:nth-child(9){transform:rotate(240deg);animation-delay:-0.3s;}div:nth-child(10){transform:rotate(270deg);animation-delay:-0.2s;}div:nth-child(11){transform:rotate(300deg);animation-delay:-0.1s;}div:nth-child(12){transform:rotate(330deg);animation-delay:0s;}@keyframes lds-spinner{0%{opacity:1;}100%{opacity:0;}}']),X=function(){return c.a.createElement(V,null,c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null))},Z=u.a.div.withConfig({displayName:"GameMenu__MenuBar",componentId:"sc-1evhkun-0"})(["display:flex;flex-direction:column;margin-top:1.5rem;margin-left:2rem;text-align:center;@media (max-aspect-ratio:100/99){margin-left:auto;margin-right:auto;}"]),$=u.a.div.withConfig({displayName:"GameMenu__MenuItem",componentId:"sc-1evhkun-1"})(["position:relative;display:",";align-self:center;padding-bottom:0.5rem;"],(function(e){return e.hidden?"none":"flex"})),ee=u.a.button.withConfig({displayName:"GameMenu__GameButton",componentId:"sc-1evhkun-2"})(["background:white;color:#073642;border:1px solid #073642;border-radius:0.3rem;font-size:1rem;font-weight:bold;padding:0.5rem;width:11rem;box-shadow:1px 1px 1px #073642;&:hover{background:#073642;color:white;cursor:pointer;}"]),te=u.a.label.withConfig({displayName:"GameMenu__Label",componentId:"sc-1evhkun-3"})(["position:absolute;top:1.3rem;width:100%;text-align:center;font-size:0.8rem;color:#073642;"]),ne=Object(u.a)($).withConfig({displayName:"GameMenu__GameResult",componentId:"sc-1evhkun-4"})(["padding-top:2rem;font-weight:bold;font-size:1.5rem;color:#dc322f;;"]),ae=function(e){var t=e.isAiThinking,n=e.gameEnded,a=e.winningPlayerColor,i=e.startNewGame,r=e.forceAiMove,o=e.searchDepth,l=e.setSearchDepth;return c.a.createElement(Z,null,c.a.createElement($,{hidden:t},c.a.createElement(ee,{disabled:t,onClick:i},"New Game")),c.a.createElement($,{hidden:t||n},c.a.createElement(ee,{disabled:t||n,onClick:r,title:"Let computer play the current color"},"Computer Move")),c.a.createElement($,{hidden:t},c.a.createElement(te,{htmlFor:"game-menu_difficulty-slider"},"Difficulty"),c.a.createElement("input",{id:"game-menu_difficulty-slider",type:"range",min:"4",max:"6",title:"Difficulty",value:o,onChange:function(e){return l(e.target.value)}})),t&&c.a.createElement(X,null),n&&c.a.createElement(ne,null,a?(1===a?"White":"Black")+" wins!":"Stalemate!"))},ie=n(19),re=n(20),oe=n(41),ce=function(){function e(){Object(ie.a)(this,e)}return Object(re.a)(e,[{key:"init",value:function(){var e=Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.engine){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(oe.instantiate)(fetch("./as-api.wasm"));case 4:this.engine=e.sent,console.log("Engine initialized");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"calculateMove",value:function(e,t,n){console.log("Start calculation of move ...");var a=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),i=this.engine.__retain(a),r=this.engine.calculateMove(i,t,n),o=le.fromEncodedMove(r);return this.engine.__release(i),console.log("Calculation finished"),o}},{key:"performMove",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.performMove(a,t.encodedMove),r=this.engine.__getArray(i);return this.engine.__release(a),this.engine.__release(i),r}},{key:"generateMoves",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.generatePlayerMoves(a,t),r=this.engine.__getArray(i);return this.engine.__release(i),this.engine.__release(a),r.map(le.fromEncodedMove)}},{key:"isCheckMate",value:function(e,t){var n=this.engine.__allocArray(this.engine.INT32ARRAY_ID,e),a=this.engine.__retain(n),i=this.engine.isCheckMate(a,t);return this.engine.__release(a),i}}]),e}(),le=function(){function e(t,n,a){Object(ie.a)(this,e),this.piece=t,this.start=n,this.end=a,this.encodedMove=t|n<<3|a<<10}return Object(re.a)(e,null,[{key:"fromEncodedMove",value:function(t){return new e(7&t,t>>3&127,t>>10&127)}}]),e}(),se=new ce,de=h()(),ue=[99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,-4,-2,-3,-5,-6,-3,-2,-4,99,99,-1,-1,-1,-1,-1,-1,-1,-1,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,0,0,0,0,0,0,0,0,99,99,1,1,1,1,1,1,1,1,99,99,4,2,3,5,6,3,2,4,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,0],me=u.a.div.withConfig({displayName:"Game__GameArea",componentId:"qivay-0"})(["display:flex;flex-wrap:wrap;"]),he=function(){var e=Object(o.useState)(1),t=Object(d.a)(e,2),n=t[0],a=t[1],i=Object(o.useState)(!1),r=Object(d.a)(i,2),l=r[0],s=r[1],u=Object(o.useState)(ue),m=Object(d.a)(u,2),h=m[0],f=m[1],p=Object(o.useState)(!1),g=Object(d.a)(p,2),v=g[0],b=g[1],y=Object(o.useState)({start:-1,end:-1}),w=Object(d.a)(y,2),_=w[0],k=w[1],x=Object(o.useState)(se.generateMoves(h,n)),E=Object(d.a)(x,2),M=E[0],j=E[1],I=Object(o.useState)(new Set),O=Object(d.a)(I,2),C=O[0],A=O[1],P=Object(o.useState)(),S=Object(d.a)(P,2),D=S[0],N=S[1],G=Object(o.useState)(5),R=Object(d.a)(G,2),T=R[0],B=R[1],z=function(e,t,n){s(!1),k(t);var i=se.performMove(e,t);if(f(i),se.isCheckMate(i,-n))return b(!0),void N(n);var r=se.generateMoves(i,-n);(j(r),0!==r.length)?a(-n):b(!0)};return c.a.createElement(me,null,c.a.createElement(H,{board:h,lastMove:_,currentPieceMoves:C,handlePlayerMove:function(e,t,i){var r=Math.abs(e);if(!v&&!l&&function(e,t){return M.some((function(n){return n.start===e&&n.end===t}))}(t,i)){if(k({start:t,end:i}),1===r&&(1===n&&i<29||-1===n&&i>90))switch(prompt("Choose promotion (Q, R, B, K)","Q").toUpperCase()){case"R":r=4;break;case"B":r=3;break;case"K":r=6;break;case"Q":default:r=5}var o=se.performMove(h,new le(r,t,i));if(f(o),se.isCheckMate(o,-n))return b(!0),void N(n);0!==se.generateMoves(o,-n).length?(s(!0),j([]),de.calculateMove(o,-n,T).then((function(e){return z(o,e,-n)})),a(-n)):b(!0)}},updatePossibleMoves:function(e){var t=M.filter((function(t){return t.start===e})).map((function(e){return e.end}));A(new Set(t))},clearPossibleMoves:function(){A(new Set)}}),c.a.createElement(ae,{isAiThinking:l,gameEnded:v,winningPlayerColor:D,startNewGame:function(){f(ue),a(1),b(!1),k({start:-1,end:-1}),N(void 0),j(se.generateMoves(ue,n)),A(new Set)},forceAiMove:function(){s(!0),de.calculateMove(h,n,T).then((function(e){return z(h,e,n)}))},searchDepth:T,setSearchDepth:B}))},fe=n(66),pe=n(42),ge=n(43),ve=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=t.map((function(t){return t(e)}));return{setup:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.setup.apply(e,t)}))},teardown:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.teardown.apply(e,t)}))},connectDropTarget:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDropTarget.apply(e,t)}))},connectDragPreview:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDragPreview.apply(e,t)}))},connectDragSource:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.forEach((function(e){return e.connectDragSource.apply(e,t)}))}}}};var be=function(){return c.a.createElement("main",null,c.a.createElement(fe.a,{backend:ve(pe.a,ge.a)},c.a.createElement(he,null)))};Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.init();case 2:s.a.render(c.a.createElement(be,null),document.getElementById("root"));case 3:case"end":return e.stop()}}),e)})))()}},[[47,1,2]]]);
//# sourceMappingURL=main.7188bd7f.chunk.js.map