{"version":3,"sources":["engine/engine.worker.js","ui/img/white_pawn.svg","ui/img/black_pawn.svg","ui/img/white_knight.svg","ui/img/black_knight.svg","ui/img/white_bishop.svg","ui/img/black_bishop.svg","ui/img/white_rook.svg","ui/img/black_rook.svg","ui/img/white_queen.svg","ui/img/black_queen.svg","ui/img/white_king.svg","ui/img/black_king.svg","ui/AnimatedSpinner.js","engine/move.js","ui/Field.js","ui/Piece.js","ui/Board.js","ui/GameMenu.js","engine/constants.js","ui/Game.js","ui/App.js","index.js"],"names":["addMethods","methods","module","exports","w","Worker","name","AnimatedSpinner","styled","div","Move","piece","start","end","this","encodedMove","Math","abs","FieldDiv","props","isEven","markColor","Field","boardIndex","children","movePiece","isStart","isEnd","isPossibleTarget","useDrop","accept","drop","item","monitor","pieceId","dropRef","fieldMarkStyle","ref","style","position","className","whiteImages","whitePawn","whiteKnight","whiteBishop","whiteRook","whiteQueen","whiteKing","blackImages","blackPawn","blackKnight","blackBishop","blackRook","blackQueen","blackKing","pieceNames","PieceImage","img","isFirefox","InstallTrigger","Piece","color","onPickup","onDrop","useDrag","type","begin","dropResult","collect","isDragging","drag","pieceImage","src","alt","BoardGrid","Board","board","isRotated","lastMove","currentPieceMoves","handlePlayerMove","updatePossibleMoves","clearPossibleMoves","slice","map","_","idx","rotatedIndex","key","has","MenuBar","MenuItem","hidden","GameButton","button","GameResult","IconRadioInput","input","IconRadioLabel","label","getGameResultIcon","winningPlayerColor","humanPlayerColor","faMedal","faRobot","faBalanceScale","IconRadioButtons","currentValue","options","onChange","value","description","icon","Fragment","id","defaultChecked","e","target","htmlFor","title","size","GameMenu","isAiThinking","firstMovePlayed","gameEnded","startNewGame","switchSides","rotateBoard","difficultyLevel","setDifficultyLevel","canUndoMove","undoMove","disabled","onClick","faPlus","faExchangeAlt","faUndo","faRetweet","faDiceOne","faDiceTwo","faDiceThree","faDiceFour","faDiceFive","engine","engineWorkerLoader","GameArea","startPosition","Centered","Game","useState","setRotateBoard","activePlayer","setActivePlayer","setHumanPlayerColor","setAiThinking","setBoard","setGameEnded","availableMoves","setAvailableMoves","Set","setCurrentPieceMoves","winningPlayer","setWinningPlayer","moveHistory","setMoveHistory","length","addMove","useCallback","move","updateGame","state","a","moves","checkMate","handleAIMove","performMove","gameState","useEffect","init","newGame","setPosition","canMove","some","calculateAIMove","calculateMove","aiMove","undefined","previousMoveHistory","choice","prompt","toUpperCase","interimBoard","possibleMoves","filter","multiBackends","backendFactories","manager","backends","b","setup","args","forEach","apply","teardown","connectDropTarget","connectDragPreview","connectDragSource","App","DndProvider","backend","HTML5Backend","TouchBackend","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.24b3823f.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"init\",\"newGame\",\"calculateMove\",\"performMove\",\"setPosition\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"5cfbaf910f6743ac775f.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","module.exports = __webpack_public_path__ + \"static/media/white_pawn.41da1b5b.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_pawn.3cab4671.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_knight.3ece5029.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_knight.88ad52be.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_bishop.36a96cf8.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_bishop.341337f4.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_rook.007b43f5.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_rook.e7f61dec.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_queen.51d538db.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_queen.87612c77.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_king.9e716b1e.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_king.12ae1430.svg\";","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport styled from 'styled-components/macro';\nimport React from 'react';\n\n/* Animated spinner adapted from https://loading.io/css/ */\nconst AnimatedSpinner = styled.div`\n  color: #073642;\n  display: inline-block;\n  position: relative;\n  width: 80px;\n  height: 80px;\n  \n  margin-top: 1rem;\n  margin-right: 0.5rem;\n  margin-left: 1.5rem;\n  \n  div {\n    transform-origin: 40px 40px;\n    animation: lds-spinner 1.2s linear infinite;\n  }\n  div:after {\n    content: \" \";\n    display: block;\n    position: absolute;\n    top: 3px;\n    left: 37px;\n    width: 6px;\n    height: 18px;\n    border-radius: 20%;\n    background: #073642;\n  }\n  div:nth-child(1) {\n    transform: rotate(0deg);\n    animation-delay: -1.1s;\n  }\n  div:nth-child(2) {\n    transform: rotate(30deg);\n    animation-delay: -1s;\n  }\n  div:nth-child(3) {\n    transform: rotate(60deg);\n    animation-delay: -0.9s;\n  }\n  div:nth-child(4) {\n    transform: rotate(90deg);\n    animation-delay: -0.8s;\n  }\n  div:nth-child(5) {\n    transform: rotate(120deg);\n    animation-delay: -0.7s;\n  }\n  div:nth-child(6) {\n    transform: rotate(150deg);\n    animation-delay: -0.6s;\n  }\n  div:nth-child(7) {\n    transform: rotate(180deg);\n    animation-delay: -0.5s;\n  }\n  div:nth-child(8) {\n    transform: rotate(210deg);\n    animation-delay: -0.4s;\n  }\n  div:nth-child(9) {\n    transform: rotate(240deg);\n    animation-delay: -0.3s;\n  }\n  div:nth-child(10) {\n    transform: rotate(270deg);\n    animation-delay: -0.2s;\n  }\n  div:nth-child(11) {\n    transform: rotate(300deg);\n    animation-delay: -0.1s;\n  }\n  div:nth-child(12) {\n    transform: rotate(330deg);\n    animation-delay: 0s;\n  }\n  @keyframes lds-spinner {\n    0% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n`\n\nexport default () => (\n  <AnimatedSpinner>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n  </AnimatedSpinner>\n);\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2019 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nexport class Move {\n  constructor(piece, start, end) {\n    this.start = start;\n    this.end = end;\n    this.encodedMove = Math.abs(piece) | (start << 3) | (end << 10);\n  }\n\n  static fromEncodedMove(encodedMove) {\n    const piece = encodedMove & 0x7; // Bits 0-2\n    const start = (encodedMove >> 3) & 0x7F; // Bits 3-10\n    const end = (encodedMove >> 10) & 0x7F; // Bit 10-17\n\n    return new Move(piece, start, end);\n  }\n}\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport { useDrop } from 'react-dnd';\nimport styled from 'styled-components/macro';\n\nconst FieldDiv = styled.div`\n  position: relative;\n  background-color: ${props => props.isEven ? \"#fdf6e3\" : \"#eee8d5\"};\n  \n  // always keep board size rectangular and maximized to the smaller axis\n  @media (min-aspect-ratio: 99/100) {\n    width: 12.5vh;\n    height: 12.5vh;\n  }\n  @media (max-aspect-ratio: 100/99) {\n    width: 12.5vw;\n    height: 12.5vw;\n  }\n  \n  &.move-mark:before {\n    position: absolute;\n    top: 4%;\n    left: 4%;\n    bottom: 4%;\n    right: 4%;\n    content: '';\n    display: block;\n    border: 0.5vh solid ${props => props.markColor};\n    border-radius: 50%;\n  }\n`;\n\nconst Field = ({\n  boardIndex,\n  children,\n  movePiece,\n  isEven,\n  isStart,\n  isEnd,\n  isPossibleTarget\n}) => {\n  const [, dropRef] = useDrop({\n    accept: 'PIECE',\n    drop: (item, monitor) => {\n      movePiece(item.pieceId, item.boardIndex, boardIndex);\n    }\n  });\n\n  const fieldMarkStyle =\n    isStart || isEnd || isPossibleTarget ? 'move-mark' : '';\n\n  // prettier-ignore\n  const markColor = isPossibleTarget ? 'rgba(169,189,0,0.69)'\n                  : isStart ? '#dc322f9f'\n                  : isEnd ? '#dc322faf'\n                  : 'white';\n\n  return (\n    <FieldDiv\n      ref={dropRef}\n      isEven={isEven}\n      style={{ position: 'relative' }}\n      isStart={isStart}\n      markColor={markColor}\n      className={fieldMarkStyle}\n    >\n      {children}\n    </FieldDiv>\n  );\n};\n\nexport default Field;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport { useDrag } from 'react-dnd';\nimport styled from 'styled-components/macro';\n\nimport whitePawn from './img/white_pawn.svg';\nimport blackPawn from './img/black_pawn.svg';\nimport whiteKnight from './img/white_knight.svg';\nimport blackKnight from './img/black_knight.svg';\nimport whiteBishop from './img/white_bishop.svg';\nimport blackBishop from './img/black_bishop.svg';\nimport whiteRook from './img/white_rook.svg';\nimport blackRook from './img/black_rook.svg';\nimport whiteQueen from './img/white_queen.svg';\nimport blackQueen from './img/black_queen.svg';\nimport whiteKing from './img/white_king.svg';\nimport blackKing from './img/black_king.svg';\n\nconst whiteImages = [\n  whitePawn,\n  whiteKnight,\n  whiteBishop,\n  whiteRook,\n  whiteQueen,\n  whiteKing\n];\n\nconst blackImages = [\n  blackPawn,\n  blackKnight,\n  blackBishop,\n  blackRook,\n  blackQueen,\n  blackKing\n];\n\nconst pieceNames = [ 'Pawn', 'Knight', 'Bishop', 'Rook', 'Queen', 'King' ]\n\nconst PieceImage = styled.img`\n  display: block;\n  margin: 13%;\n  height: 74%;\n  width: 74%;\n\n  &.dragging {\n    visibility: hidden;\n  }\n  \n  // Workaround for wrong Drag'n'Drop preview image rendering in Chrome (see https://github.com/react-dnd/react-dnd/issues/832)\n  -webkit-transform: rotateZ(0deg);\n`;\n\nconst isFirefox = typeof InstallTrigger !== 'undefined';\n\nconst Piece = ({ boardIndex, color, piece, onPickup, onDrop }) => {\n  const pieceId = Math.abs(piece);\n  const img =\n    color === 'black' ? blackImages[pieceId - 1] : whiteImages[pieceId - 1];\n\n  const [{ isDragging }, drag] = useDrag({\n    item: {\n      type: 'PIECE',\n      pieceId,\n      boardIndex\n    },\n    begin: monitor => onPickup(boardIndex),\n    end: dropResult => onDrop(boardIndex),\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  });\n\n  const pieceImage =\n    <PieceImage\n      ref={drag}\n      src={img}\n      alt={pieceNames[pieceId - 1]}\n      className={isDragging ? 'dragging' : ''}\n    />;\n\n  // Workaround for wrong Drag'n'Drop preview image rendering in Firefox\n  return isFirefox\n    ?  <div ref={drag}>{pieceImage}</div>\n    : pieceImage;\n};\n\nexport default Piece;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport Field from './Field';\nimport Piece from './Piece';\nimport styled from 'styled-components/macro';\n\nconst BoardGrid = styled.div`\n    display: grid;\n    grid-template-columns: repeat(8, 1fr);\n    grid-template-rows: repeat(8, 1fr);\n\n    @media (min-aspect-ratio: 99/100) {\n      width: 100vh;\n      height: 100vh;\n    }\n    @media (max-aspect-ratio: 100/99) {\n      width: 100vw;\n      height: 100vw;\n    }\n    \n    box-shadow: 3px 3px 3px #586e75;\n`;\n\nconst Board = ({board, isRotated, lastMove, currentPieceMoves, handlePlayerMove, updatePossibleMoves, clearPossibleMoves}) => {\n  return (\n    <BoardGrid isRotated={isRotated}>\n      {board.slice(0, 64).map((_, idx) => {\n        const rotatedIndex = isRotated ? 63 - idx : idx;\n        const item = board[rotatedIndex];\n\n        return (\n          <Field\n            key={rotatedIndex}\n            boardIndex={rotatedIndex}\n            movePiece={handlePlayerMove}\n            isEven={(rotatedIndex + (rotatedIndex >> 3)) % 2 === 0}\n            isStart={rotatedIndex === lastMove.start}\n            isEnd={rotatedIndex === lastMove.end}\n            isPossibleTarget={currentPieceMoves.has(rotatedIndex)}\n          >\n            {item !== 0 && (\n              <Piece\n                boardIndex={rotatedIndex}\n                color={item < 0 ? 'black' : 'white'}\n                piece={item}\n                onPickup={updatePossibleMoves}\n                onDrop={clearPossibleMoves}\n              />\n            )}\n          </Field>\n        );\n      })}\n    </BoardGrid>\n  );\n};\n\nexport default Board;","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport { WHITE } from '../engine/constants';\nimport AnimatedSpinner from './AnimatedSpinner';\nimport {\n  faBalanceScale,\n  faDiceFive,\n  faDiceFour,\n  faDiceOne,\n  faDiceThree,\n  faDiceTwo,\n  faExchangeAlt,\n  faMedal,\n  faPlus,\n  faRetweet,\n  faRobot,\n  faUndo\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nconst MenuBar = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 1rem;\n  margin-left: 1.5rem;\n  text-align: center;\n  align-items: center;\n\n  // center menubar below board, if window width is < window height\n  @media (max-aspect-ratio: 100/99) {\n    margin-left: auto;\n    margin-right: auto;\n    flex-flow: column-reverse;\n  }\n`;\n\nconst MenuItem = styled.div`\n  position: relative;\n  display: ${props => (props.hidden ? 'none' : 'flex')};\n  padding-bottom: 0.5rem;\n  flex-direction: column;\n  \n  @media (max-aspect-ratio: 100/99) {\n    flex-direction: row;\n    align-self: center;\n  }\n`;\n\nconst GameButton = styled.button`\n  background: white;\n  color: #073642;\n  border: 1px solid #073642;\n  border-radius: 0.3rem;\n  font-size: 1rem;\n  font-weight: bold;\n  padding: 0.5rem 0.4rem;\n  width: 2.5rem;\n  margin: 0.3rem;\n  box-shadow: 1px 1px 1px #073642;\n  \n  &[disabled] {\n    display: none;\n  }\n\n  & :hover {\n    background: #073642;\n    color: white;\n    cursor: pointer;\n  }\n`;\n\nconst GameResult = styled(MenuItem)`\n  margin-top: 0.3rem;\n  font-weight: bold;\n  font-size: 1.5rem;\n  color: #073642;\n  width: 100%;\n  align-items: center;\n  \n  svg {\n    margin-left: 1rem;\n    margin-right: 1rem;\n  }\n`;\n\nconst IconRadioInput = styled.input`\n  display: none;\n  \n  &:checked + label {\n    opacity: 1;\n  }\n`;\n\nconst IconRadioLabel = styled.label`\n  color: #073642;\n  margin: 0.2rem;\n  opacity: 0.2;\n  \n  & :hover {\n    opacity: 0.5;\n    cursor: pointer;\n  }\n`\n\nconst colorName = color => (color === WHITE ? 'White' : 'Black');\n\nconst getGameResultIcon = (winningPlayerColor, humanPlayerColor) => {\n  if (!winningPlayerColor) {\n    return faBalanceScale;\n  }\n\n  return winningPlayerColor === humanPlayerColor\n    ? faMedal\n    : faRobot;\n}\n\nconst GameMenu = ({\n  isAiThinking,\n  firstMovePlayed,\n  humanPlayerColor,\n  gameEnded,\n  winningPlayerColor,\n  startNewGame,\n  switchSides,\n  rotateBoard,\n  difficultyLevel,\n  setDifficultyLevel,\n  canUndoMove,\n  undoMove,\n}) => (\n  <MenuBar>\n    {gameEnded &&\n    <GameResult>\n      <FontAwesomeIcon icon={getGameResultIcon(winningPlayerColor, humanPlayerColor)} size=\"2x\" />\n      {winningPlayerColor ? colorName(winningPlayerColor) + ' wins!' : 'Draw!'}\n    </GameResult>\n    }\n\n    <MenuItem hidden={isAiThinking}>\n\n      <GameButton disabled={!firstMovePlayed} onClick={startNewGame}>\n        <FontAwesomeIcon icon={faPlus} title=\"Start new game\" />\n      </GameButton>\n\n      <GameButton disabled={gameEnded || firstMovePlayed} onClick={switchSides}>\n        <FontAwesomeIcon icon={faExchangeAlt} title=\"Switch sides\" />\n      </GameButton>\n\n      <GameButton disabled={!canUndoMove || gameEnded} onClick={undoMove}>\n        <FontAwesomeIcon icon={faUndo} title=\"Undo move\" />\n      </GameButton>\n\n      <GameButton disabled={gameEnded || !firstMovePlayed} onClick={rotateBoard}>\n        <FontAwesomeIcon icon={faRetweet} title=\"Rotate board\" />\n      </GameButton>\n\n    </MenuItem>\n\n    <MenuItem hidden={isAiThinking || gameEnded}>\n      <IconRadioButtons currentValue={difficultyLevel} name=\"difficulty-level\" onChange={setDifficultyLevel}\n                        options={[\n                          {value: 1, description: \"Difficulty level 1 (easy)\", icon: faDiceOne},\n                          {value: 2, description: \"Difficulty level 2\", icon: faDiceTwo},\n                          {value: 3, description: \"Difficulty level 3\", icon: faDiceThree},\n                          {value: 4, description: \"Difficulty level 4\", icon: faDiceFour},\n                          {value: 5, description: \"Difficulty level 5 (hard)\", icon: faDiceFive},\n                        ]} />\n    </MenuItem>\n\n    {isAiThinking && <AnimatedSpinner /> }\n\n  </MenuBar>\n);\n\nconst IconRadioButtons = ({currentValue, name, options, onChange}) => (\n  <>\n    {options.map(({value, description, icon}) => (\n      <React.Fragment key={`${name}-${value}`}>\n        <IconRadioInput type=\"radio\" id={`${name}-${value}`} name={name} value={value} defaultChecked={currentValue === value} onChange={(e) => onChange(e.target.value)} />\n        <IconRadioLabel htmlFor={`${name}-${value}`}>\n          <FontAwesomeIcon icon={icon} title={description} size=\"2x\" />\n        </IconRadioLabel>\n      </React.Fragment>\n      ))}\n  </>\n);\n\nexport default GameMenu;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nexport const BLACK = -1;\nexport const WHITE = 1;\n\nexport const P = 1; // pawn\nexport const N = 2; // knight\nexport const B = 3; // bishop\nexport const R = 4; // rook\nexport const Q = 5; // queen\nexport const K = 6; // king\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components/macro';\n\nimport engineWorkerLoader from 'workerize-loader!../engine/engine.worker'; // eslint-disable-line import/no-webpack-loader-syntax\nimport { B, BLACK, N, P, Q, R, WHITE } from '../engine/constants';\nimport AnimatedSpinner from './AnimatedSpinner';\nimport { Move } from '../engine/move';\nimport Board from './Board';\nimport GameMenu from './GameMenu';\n\nconst engine = engineWorkerLoader();\n\nconst GameArea = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nconst startPosition = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\n\nconst nextPlayer = playerColor => -playerColor;\n\nconst Game = () => {\n  const [rotateBoard, setRotateBoard] = useState(false);\n  const [activePlayer, setActivePlayer] = useState(WHITE);\n  const [humanPlayerColor, setHumanPlayerColor] = useState(WHITE);\n  const [isAiThinking, setAiThinking] = useState(false);\n  const [board, setBoard] = useState();\n  const [gameEnded, setGameEnded] = useState(false);\n  const [availableMoves, setAvailableMoves] = useState([]);\n  const [currentPieceMoves, setCurrentPieceMoves] = useState(new Set());\n  const [winningPlayer, setWinningPlayer] = useState();\n  const [difficultyLevel, setDifficultyLevel] = useState(3);\n  const [moveHistory, setMoveHistory] = useState([]);\n\n  const lastMove = moveHistory.length > 0 ? moveHistory[moveHistory.length - 1] : { start: -1, end: -1 };\n\n  const clearAvailableMoves = () => setAvailableMoves([]);\n  const addMove = useCallback(move => setMoveHistory([...moveHistory, move]), [setMoveHistory, moveHistory]);\n\n  const updateGame = useCallback(async state => {\n    setBoard(state.board);\n    setAvailableMoves(state.moves);\n    setActivePlayer(state.activePlayer);\n\n    if (state.gameEnded) {\n      setGameEnded(true);\n\n      if (state.checkMate) {\n        setWinningPlayer(nextPlayer(state.activePlayer));\n      }\n    }\n  }, []);\n\n  const handleAIMove = useCallback(async move => {\n    const gameState = await engine.performMove(move);\n    setAiThinking(false);\n    await updateGame(gameState);\n    addMove(move);\n  }, [updateGame, addMove]);\n\n  useEffect(() => {\n    (async () => {\n      await engine.init();\n      await engine.newGame();\n      const gameState = await engine.setPosition(startPosition, []);\n      await updateGame(gameState);\n    })();\n  }, [updateGame]);\n\n  const canMove = (start, end) => {\n    return availableMoves.some(\n      move => move.start === start && move.end === end\n    );\n  };\n\n  const calculateAIMove = useCallback(async () => {\n    clearAvailableMoves();\n    setAiThinking(true);\n\n    const aiMove = await engine.calculateMove(difficultyLevel);\n    await handleAIMove(aiMove);\n  }, [difficultyLevel, handleAIMove]);\n\n  useEffect(() => {\n    if (humanPlayerColor !== activePlayer) {\n      calculateAIMove();\n    }\n  }, [humanPlayerColor, activePlayer, calculateAIMove]);\n\n  const switchSides = () => {\n    setRotateBoard(true);\n    setHumanPlayerColor(-humanPlayerColor);\n  }\n\n  const startNewGame = async () => {\n    setActivePlayer(WHITE);\n    setHumanPlayerColor(WHITE);\n\n    await engine.newGame();\n    const gameState = await engine.setPosition(startPosition, []);\n\n    setRotateBoard(false);\n    setGameEnded(false);\n    setMoveHistory([]);\n    setWinningPlayer(undefined);\n    setCurrentPieceMoves(new Set());\n\n    await updateGame(gameState);\n  };\n\n  const undoMove = useCallback(async () => {\n    const previousMoveHistory = moveHistory.slice(0, moveHistory.length - 2);\n    const gameState = await engine.setPosition(startPosition, previousMoveHistory);\n    setMoveHistory(previousMoveHistory);\n    await updateGame(gameState);\n  }, [moveHistory, setMoveHistory, updateGame]);\n\n  const handlePlayerMove = async (piece, start, end) => {\n    let pieceId = Math.abs(piece);\n    if (gameEnded || isAiThinking) {\n      return;\n    }\n\n    if (!canMove(start, end)) {\n      return;\n    }\n\n    setCurrentPieceMoves(new Set());\n\n    // TODO: Replace browser prompt dialog with own dialog\n    if (pieceId === P && ((activePlayer === WHITE && end < 8) || (activePlayer === BLACK && end >= 56))) {\n      // Promotion\n      const choice = prompt('Choose promotion (Q, R, B, N)', 'Q');\n      switch (choice.toUpperCase()) {\n        case 'R':\n          pieceId = R;\n          break;\n        case 'B':\n          pieceId = B;\n          break;\n        case 'N':\n          pieceId = N;\n          break;\n        case 'Q':\n        default:\n          pieceId = Q;\n          break;\n      }\n    }\n\n    const interimBoard = board.slice();\n    interimBoard[start] = 0;\n    setBoard(interimBoard);\n\n    const gameState = await engine.performMove(new Move(pieceId, start, end));\n    addMove(new Move(piece, start, end));\n    await updateGame(gameState);\n  };\n\n  const updatePossibleMoves = start => {\n    const possibleMoves = availableMoves\n      .filter(move => move.start === start)\n      .map(move => move.end);\n    setCurrentPieceMoves(new Set(possibleMoves));\n  };\n\n  const clearPossibleMoves = () => {\n    setCurrentPieceMoves(new Set());\n  };\n\n  return (\n    board\n      ? (\n        <GameArea>\n          <Board\n            board={board}\n            isRotated={rotateBoard}\n            lastMove={lastMove}\n            currentPieceMoves={currentPieceMoves}\n            handlePlayerMove={handlePlayerMove}\n            updatePossibleMoves={updatePossibleMoves}\n            clearPossibleMoves={clearPossibleMoves}\n          />\n          <GameMenu\n            isAiThinking={isAiThinking}\n            firstMovePlayed={lastMove.start !== -1}\n            humanPlayerColor={humanPlayerColor}\n            gameEnded={gameEnded}\n            winningPlayerColor={winningPlayer}\n            startNewGame={startNewGame}\n            switchSides={switchSides}\n            rotateBoard={() => setRotateBoard(!rotateBoard)}\n            difficultyLevel={difficultyLevel}\n            setDifficultyLevel={setDifficultyLevel}\n            canUndoMove={!gameEnded && moveHistory.length > 1}\n            undoMove={undoMove}\n          />\n        </GameArea>\n      )\n      : (\n        <Centered><AnimatedSpinner/></Centered>\n      )\n  );\n};\n\nconst Centered = styled.div`\n  position: absolute;\n  left: calc(50% - 60px);\n  top: calc(50% - 60px);\n`;\n\nexport default Game;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport Game from './Game';\nimport { DndProvider } from 'react-dnd';\nimport HTML5Backend from 'react-dnd-html5-backend';\nimport TouchBackend from 'react-dnd-touch-backend';\n\nconst multiBackends = (...backendFactories) =>\n  function(manager) {\n    const backends = backendFactories.map(b => b(manager));\n    return {\n      setup: (...args) =>\n        backends.forEach(b => b.setup.apply(b, args)),\n      teardown: (...args) =>\n        backends.forEach(b => b.teardown.apply(b, args)),\n      connectDropTarget: (...args) =>\n        backends.forEach(b => b.connectDropTarget.apply(b, args)),\n      connectDragPreview: (...args) =>\n        backends.forEach(b => b.connectDragPreview.apply(b, args)),\n      connectDragSource: (...args) =>\n        backends.forEach(b => b.connectDragSource.apply(b, args)),\n    };\n  };\n\nfunction App() {\n  return (\n    <main>\n      <DndProvider backend={multiBackends(HTML5Backend, TouchBackend)}>\n        <Game />\n      </DndProvider>\n    </main>\n  );\n}\n\nexport default App;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './ui/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}